<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CHROMA.Views.CreatePage"
			 Title="Create">

	<!-- INCLUDE THIS BETWEEN CLASS AND TITLE
	         x:DataType="vm:CreateViewModel"
             xmlns:vm="clr-namespace:CHROMA.ViewModels"
	-->

	<ScrollView>
		<VerticalStackLayout Padding="16" Spacing="16">

			<!-- Section 1: Color Input -->
			<Border Padding="12">
				<VerticalStackLayout Spacing="8">
					<Label Text="Base Color" FontAttributes="Bold"/>
					<HorizontalStackLayout Spacing="8">
						<Entry Text="{Binding BaseHex}" Placeholder="#E96841" Keyboard="Chat"/>
						<Button Text="Clear" Command="{Binding ClearCommand}" />
					</HorizontalStackLayout>
					<Label Text="{Binding BaseHexPreview}" FontSize="12" TextColor="Gray"/>
					<!-- simple live swatch -->
					<BoxView HeightRequest="24" CornerRadius="6" Color="{Binding BaseColor}" />
				</VerticalStackLayout>
			</Border>

			<!-- Section 2: Harmony Results -->
			<Border Padding="12">
				<VerticalStackLayout Spacing="8">
					<Label Text="Harmony Results" FontAttributes="Bold"/>
					<Picker Title="Scheme" ItemsSource="{Binding Schemes}" SelectedItem="{Binding SelectedScheme}" />
					<!-- Cards list -->
					<CollectionView ItemsSource="{Binding GeneratedPalettes}" SelectionMode="Single">
						<CollectionView.ItemTemplate>
							<DataTemplate>
								<Border Padding="8" Margin="0,4">
									<VerticalStackLayout Spacing="6">
										<Label Text="{Binding Name}" FontAttributes="Bold"/>
										<HorizontalStackLayout Spacing="4">
											<BoxView WidthRequest="28" HeightRequest="20" CornerRadius="4" Color="{Binding Colors[0]}"/>
											<BoxView WidthRequest="28" HeightRequest="20" CornerRadius="4" Color="{Binding Colors[1]}"/>
											<BoxView WidthRequest="28" HeightRequest="20" CornerRadius="4" Color="{Binding Colors[2]}"/>
											<BoxView WidthRequest="28" HeightRequest="20" CornerRadius="4" Color="{Binding Colors[3]}"/>
										</HorizontalStackLayout>
										<!-- S/L sliders, Hue locked -->
										<Grid ColumnDefinitions="*,*" ColumnSpacing="8">
											<VerticalStackLayout Grid.Column="0">
												<Label Text="Saturation"/>
												<Slider Minimum="0" Maximum="1" Value="{Binding Saturation, Mode=TwoWay}"/>
											</VerticalStackLayout>
											<VerticalStackLayout Grid.Column="1">
												<Label Text="Lightness/Value"/>
												<Slider Minimum="0" Maximum="1" Value="{Binding Lightness, Mode=TwoWay}"/>
											</VerticalStackLayout>
										</Grid>
										<Button Text="Use this palette" Command="{Binding BindingContext.UsePaletteCommand, Source={x:Reference Name=PageRoot}}" CommandParameter="{Binding .}"/>
									</VerticalStackLayout>
								</Border>
							</DataTemplate>
						</CollectionView.ItemTemplate>
					</CollectionView>
				</VerticalStackLayout>
			</Border>

			<!-- Section 3: Visualization -->
			<Border Padding="12">
				<VerticalStackLayout Spacing="8">
					<Label Text="Visualization" FontAttributes="Bold"/>
					<HorizontalStackLayout Spacing="4">
						<BoxView WidthRequest="36" HeightRequest="24" CornerRadius="6" Color="{Binding ActivePalette.Colors[0]}"/>
						<BoxView WidthRequest="36" HeightRequest="24" CornerRadius="6" Color="{Binding ActivePalette.Colors[1]}"/>
						<BoxView WidthRequest="36" HeightRequest="24" CornerRadius="6" Color="{Binding ActivePalette.Colors[2]}"/>
						<BoxView WidthRequest="36" HeightRequest="24" CornerRadius="6" Color="{Binding ActivePalette.Colors[3]}"/>
					</HorizontalStackLayout>
					<Grid HeightRequest="18">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="{Binding Dist.MainPct}" />
							<ColumnDefinition Width="{Binding Dist.SecondaryPct}" />
							<ColumnDefinition Width="{Binding Dist.AccentPct}" />
						</Grid.ColumnDefinitions>
						<BoxView Grid.Column="0" Color="{Binding ActivePalette.Colors[0]}" />
						<BoxView Grid.Column="1" Color="{Binding ActivePalette.Colors[1]}" />
						<BoxView Grid.Column="2" Color="{Binding ActivePalette.Colors[2]}" />
					</Grid>
					<HorizontalStackLayout>
						<Button Text="Save" Command="{Binding SaveCommand}" />
						<Button Text="Export JSON" Command="{Binding ExportJsonCommand}" />
					</HorizontalStackLayout>
				</VerticalStackLayout>
			</Border>

		</VerticalStackLayout>
	</ScrollView>
</ContentPage>